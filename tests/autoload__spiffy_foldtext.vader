# tests/autoload__spiffy_foldtext.vader

#│ ▼1 │ Global setup
#└────┴──────────────
Execute (Globally useful function definitions): ▼2

  function! BasicSetup() "▼
    set foldmethod=marker
    set foldmarker=-v-,-^-
    silent only " Failed tests don’t run the After block.
    50vsplit " A predictable width, important for this domain.
  endfunction "▲

  function! BasicTeardown() "▼
    quit " Close vertical split
  endfunction "▲

#│ ▼1 │ Basic Integration Tests
#└────┴─────────────────────────

Given (Basic 3 line fold): ▼2
  Some buffer content -v-
  
  -^-

Before:
  call BasicSetup()

After:
  call BasicTeardown()

Execute (confirm testing assumptions): ▼2
  AssertEqual 50, winwidth(0)

Execute (basic test): ▼2
  normal zM
  AssertEqual "Some buffer content -v-  ==========|    3 lines |=", foldtextresult(1)

#│ ▼1 │ Features
#└─┬──┴─┬────────
#  │ ▼2 │ On-the-fly foldtext changing
#  └─┬──┴─┬────────────────────────────
#    │ ▼3 │ Common setup
#    └────┴──────────────

Before:
  call BasicSetup()
  vertical resize 25

After:
  call BasicTeardown()

Given (Basic 3 line fold):
  Some buffer content -v-
  
  -^-

#    │ ▼3 │ Tests
#    └────┴───────

Execute (Change foldtext at runtime (buffer local)):
  let b:spiffy_format_string = "buffer local value."
  normal zRzM

  AssertEqual "buffer local value.------", foldtextresult(1)


Execute (Change foldtext at runtime (window local)):
  let w:spiffy_format_string = "window local value."
  normal zRzM

  AssertEqual "window local value.------", foldtextresult(1)


Execute (window local overrides buffer local):
  let w:spiffy_format_string = "window local value."
  let b:spiffy_format_string = "buffer local value."
  normal zRzM

  AssertEqual "window local value.------", foldtextresult(1)


#  │ ▼2 │ Formatting Triggers
#  └─┬──┴─┬───────────────────
#    │ ▼3 │ Common setup
#    └────┴──────────────

Before:
  call BasicSetup()
  set winwidth=10
  vertical resize 10

After:
  call BasicTeardown()

Given (Basic 3 line fold):
  Some buffer content -v-
  
  -^-

#    │ ▼3 │ Tests
#    └────┴───────

Execute (Escaped percent sign):
  let w:spiffy_format_string = "%%"
  normal zRzM

  AssertEqual "%---------", foldtextresult(1)


Execute (Filled Text of line):
  Assert 0, "Write the tests"


Execute (Text of line):
  Assert 0, "Write the tests"


Execute (Split Mark):
  Assert 0, "Write the tests"


Execute (Fill Mark):
  Assert 0, "Write the tests"


Execute (Formatted Line Count):
  Assert 0, "Write the tests"


Execute (Fold level indent):
  Assert 0, "Write the tests"


Execute (Formatted Level Count):
  Assert 0, "Write the tests"


# ▼1 modeline
# vim: set ts=2 sw=2 sts=2 et fdm=marker fmr=▼,▲ :

